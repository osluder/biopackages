#$Id: perl-Catalyst-Plugin-Session-State-Cookie.spec.in,v 1.2 2006/05/04 07:14:59 allenday Exp $
%define _unpackaged_files_terminate_build 0
Distribution: Custom
Vendor: biopackages.net
Summary: Unknown
Name: perl-Catalyst-Plugin-Session-State-Cookie
Version: 0.02
Release: %{revision}.%{distro}
Packager: allenday@jugular.ctrl.ucla.edu
License: GPL or Artistic
Group: Development/Libraries
Epoch: 0
URL: http://search.cpan.org/dist/Catalyst-Plugin-Session-State-Cookie/
BuildArch: noarch
BuildRoot: %{_tmppath}/%{name}-%{version}-%{release}-root
BuildRequires: perl, biopackages, perl-Catalyst-Plugin-Session, perl-Test-MockObject
Requires: perl-Catalyst-Plugin-Session, perl-Test-MockObject

Source0: Catalyst-Plugin-Session-State-Cookie-0.02.tar.gz

%description
NAME
    Catalyst::Plugin::Session::State::Cookie - Maintain session IDs using
    cookies.

SYNOPSIS
        use Catalyst qw/Session Session::State::Cookie Session::Store::Foo/;

DESCRIPTION
    In order for Catalyst::Plugin::Session to work the session ID needs to
    be stored on the client, and the session data needs to be stored on the
    server.

    This plugin stores the session ID on the client using the cookie
    mechanism.

METHODS
    make_session_cookie
        Returns a hash reference with the default values for new cookies.

    update_session_cookie $hash_ref
        Sets the cookie based on "cookie_name" in the response object.

EXTENDED METHODS
    prepare_cookies
        Will restore if an appropriate cookie is found.

    finalize_cookies
        Will set a cookie called "session" if it doesn't exist or if it's
        value is not the current session id.

    setup_session
        Will set the "cookie_name" parameter to it's default value if it
        isn't set.

CONFIGURATION
    cookie_name
        The name of the cookie to store (defaults to
        "Catalyst::Utils::apprefix($c) . '_session'").

    cookie_domain
        The name of the domain to store in the cookie (defaults to current
        host)

    cookie_expires
        Number of seconds from now you want to elapse before cookie will
        expire. Set to 0 to create a session cookie, ie one which will die
        when the user's browser is shut down.

CAVEATS
    Sessions have to be created before the first write to be saved. For
    example:

            sub action : Local {
                    my ( $self, $c ) = @_;
                    $c->res->write("foo");
                    $c->session( ... );
                    ...
            }

    Will cause a session ID to not be set, because by the time a session is
    actually created the headers have already been sent to the client.

SEE ALSO
    Catalyst, Catalyst::Plugin::Session.

AUTHORS
    This module is derived from Catalyst::Plugin::Session::FastMmap code,
    and has been heavily modified since.

    Andrew Ford Andy Grundman Christian Hansen Yuval Kogman,
    "nothingmuch@woobling.org" Marcus Ramberg Sebastian Riedel

COPYRIGHT
    This program is free software, you can redistribute it and/or modify it
    under the same terms as Perl itself.



%prep
%setup -q -n Catalyst-Plugin-Session-State-Cookie-%{version}

%build
CFLAGS="$RPM_OPT_FLAGS" perl Makefile.PL PREFIX=$RPM_BUILD_ROOT%{_prefix}  < /dev/null
make OPTIMIZE="$RPM_OPT_FLAGS"

%install
rm -rf $RPM_BUILD_ROOT

eval `perl '-V:installarchlib'`
mkdir -p $RPM_BUILD_ROOT$installarchlib
%makeinstall

find $RPM_BUILD_ROOT -type f -a \( -name perllocal.pod -o -name .packlist \
  -o \( -name '*.bs' -a -empty \) \) -exec rm -f {} ';'
find $RPM_BUILD_ROOT -type d -depth -exec rmdir {} 2>/dev/null ';'
chmod -R u+w $RPM_BUILD_ROOT/*

[ -x /usr/lib/rpm/brp-compress ] && /usr/lib/rpm/brp-compress

find $RPM_BUILD_ROOT -type f \
| sed "s@^$RPM_BUILD_ROOT@@g" \
> %{name}-%{version}-%{release}-filelist

eval `perl -V:archname -V:installsitelib -V:installvendorlib -V:installprivlib`
for d in $installsitelib $installvendorlib $installprivlib; do
  [ -z "$d" -o "$d" = "UNKNOWN" -o ! -d "$RPM_BUILD_ROOT$d" ] && continue
  find $RPM_BUILD_ROOT$d/* -type d \
  | grep -v "/$archname\(/auto\)\?$" \
  | sed "s@^$RPM_BUILD_ROOT@%dir @g" \
  >> %{name}-%{version}-%{release}-filelist
done

if [ "$(cat %{name}-%{version}-%{release}-filelist)X" = "X" ] ; then
    echo "ERROR: EMPTY FILE LIST"
    exit 1
fi

%clean
rm -rf $RPM_BUILD_ROOT

%files -f %{name}-%{version}-%{release}-filelist
%defattr(-,root,root,-)

#%changelog
#* Thu May  4 2006 allenday@jugular.ctrl.ucla.edu - 0.02-%{revision}
#- Specfile autogenerated.
$Log: perl-Catalyst-Plugin-Session-State-Cookie.spec.in,v $
Revision 1.2  2006/05/04 07:14:59  allenday
notest

Revision 1.1  2006/05/04 07:13:14  allenday
import

